# 커피 주문 앱

## 1. 프로젝트 개요

### 1.1 프로젝트 명

커피 주문 앱

### 1.2 프로젝트 목적

사용자가 커피 메뉴를 주문하고, 관리자가 주문을 관리할 수 있는 간단한 풀스택 웹 앱

### 1.3 개발 범위

-   주문하기 화면(메뉴 선택 및 장바구니 기능)
-   관리자 화면(재고 관리 및 주문 상태 관리)
-   데이터를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스택

-   프런트엔드: HTML, CSS, 리액트, 자바스크립트
-   백엔드: Node.js, Express
-   데이터베이스: PostgreSQL

## 3. 기본 사항

-   프런엔드와 백엔드를 따로 개발
-   기본적인 웹 기술만 사용
-   학습 목적이므로 사용자 인증이나 결제 기능은 제외
-   메뉴는 커피 메뉴만 있음

## 4. 화면 구성

### 4.1 주문하기 화면

#### 4.1.1 화면 목적

사용자가 커피 메뉴를 선택하고 주문할 수 있는 메인 화면

#### 4.1.2 주요 기능

-   메뉴 목록 표시
-   메뉴 선택 및 옵션 설정
-   장바구니 기능
-   주문 요약 및 확인

#### 4.1.3 UI 구성요소

**헤더 섹션:**

-   **앱 타이틀**: 좌상단에 "COZY" 브랜드명 표시 (다크 그린 사각형 테두리)
-   **네비게이션 버튼**: 우상단에 "주문하기"와 "관리자" 버튼 배치
    -   "주문하기": 현재 활성화된 화면으로 표시
    -   "관리자": 관리자 화면으로 이동하는 버튼

**메뉴 섹션:**

-   **메뉴 카드**: 가로로 3개의 메뉴 카드 배치
    -   **제품 이미지**: 대각선 X 표시가 있는 이미지 플레이스홀더
    -   **제품 정보**:
        -   제품명 (예: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼")
        -   가격 표시 (예: "4,000원", "5,000원")
        -   설명 텍스트 ("간단한 설명...")
    -   **옵션 선택**:
        -   "샷 추가 (+500원)" 체크박스
        -   "시럽 추가 (+0원)" 체크박스
    -   **담기 버튼**: 회색 테두리의 "담기" 버튼 (장바구니 추가)

**장바구니 섹션:**

-   **섹션 제목**: "장바구니" 표시
-   **담긴 상품 목록**:
    -   상품명과 옵션 표시 (예: "아메리카노(ICE) (샷 추가) X 1")
    -   개별 가격 표시 (예: "4,500원")
-   **총 금액**: "총 금액 12,500원" 굵은 글씨로 표시
-   **주문하기 버튼**: 회색 테두리의 최종 주문 버튼

#### 4.1.4 사용자 플로우

1. **메뉴 브라우징**: 화면 상단의 메뉴 카드들을 확인하여 원하는 커피 선택
2. **옵션 설정**:
    - "샷 추가 (+500원)" 체크박스 선택 시 가격에 500원 추가
    - "시럽 추가 (+0원)" 체크박스 선택 시 추가 금액 없음
3. **장바구니 추가**: 선택한 옵션과 함께 "담기" 버튼 클릭하여 장바구니에 추가
4. **장바구니 관리**:
    - 하단 장바구니 섹션에서 추가된 상품 확인
    - 동일한 상품 추가 시 수량 자동 증가 (예: "아메리카노(HOT) X 2")
    - 각 상품별 최종 가격 계산 및 표시
5. **주문 확인**: 총 금액 확인 후 하단 "주문하기" 버튼 클릭하여 최종 주문

#### 4.1.5 기능 상세

**메뉴 카드 기능:**

-   각 메뉴 카드는 독립적으로 옵션 선택 가능
-   옵션 선택 시 실시간으로 가격 계산 및 표시 필요
-   "담기" 버튼 클릭 시 현재 선택된 옵션 상태가 장바구니에 반영

**장바구니 기능:**

-   장바구니에 동일한 상품+옵션 조합이 이미 있는 경우 수량만 증가
-   다른 옵션이 적용된 동일 상품은 별도 항목으로 추가
-   총 금액은 실시간으로 업데이트
-   장바구니가 비어있을 때는 "주문하기" 버튼 비활성화

**가격 계산 로직:**

-   기본 가격 + 추가 옵션 가격 = 단위 가격
-   단위 가격 × 수량 = 항목 총액
-   모든 항목 총액의 합 = 전체 주문 금액

#### 4.1.6 데이터 모델

**메뉴 데이터:**

-   메뉴 ID, 메뉴명, 기본 가격, 설명, 이미지 URL
-   예시:
    -   아메리카노(ICE): 4,000원
    -   아메리카노(HOT): 4,000원
    -   카페라떼: 5,000원

**옵션 데이터:**

-   옵션 ID, 옵션명, 추가 가격
-   예시:
    -   샷 추가: +500원
    -   시럽 추가: +0원

**장바구니 아이템:**

-   메뉴 ID, 선택된 옵션 배열, 수량, 계산된 단위 가격

#### 4.1.7 UI/UX 요구사항

**반응형 디자인:**

-   메뉴 카드들은 가로 스크롤 가능하도록 구현
-   모바일과 태블릿 등 다양한 화면 크기 지원

**상호작용 피드백:**

-   버튼 클릭 시 시각적 피드백 제공
-   옵션 선택 시 즉시 가격 업데이트 표시
-   장바구니 추가 시 성공 피드백

**접근성:**

-   키보드 네비게이션 지원
-   스크린 리더 호환성을 위한 적절한 라벨 제공

### 4.2 관리자 화면

#### 4.2.1 화면 목적

관리자가 주문 현황을 실시간으로 확인하고, 재고를 관리하며, 주문 상태를 업데이트할 수 있는 통합 관리 화면

#### 4.2.2 주요 기능

-   주문 현황 실시간 모니터링
-   재고 수량 실시간 조정
-   주문 상태 변경 및 관리
-   관리자 대시보드를 통한 전체 운영 현황 파악

#### 4.2.3 UI 구성요소

**헤더 섹션:**

-   **앱 타이틀**: 좌상단에 "COZY" 브랜드명 표시 (검은색 테두리 사각형)
-   **네비게이션 버튼**: 우상단에 "주문하기"와 "관리자" 버튼 배치
    -   "주문하기": 일반 상태의 네비게이션 버튼
    -   "관리자": 현재 활성화된 화면으로 검은색 테두리 사각형으로 강조 표시

**관리자 대시보드 섹션:**

-   **섹션 제목**: "관리자 대시보드" 표시
-   **주문 현황 요약 카드들** (회색 테두리 사각형으로 구분):
    -   "총 주문 1": 전체 주문 건수 표시
    -   "주문 접수 1": 접수된 주문 건수 표시
    -   "제조 중 0": 제조 진행 중인 주문 건수 표시
    -   "제조 완료 0": 제조 완료된 주문 건수 표시

**재고 현황 섹션:**

-   **섹션 제목**: "재고 현황" 표시
-   **재고 관리 카드들** (각 메뉴별로 회색 테두리 사각형으로 구분):
    -   **아메리카노 (ICE)**: 현재 재고 "10개" 표시, "+"/"-" 수량 조절 버튼
    -   **아메리카노 (HOT)**: 현재 재고 "10개" 표시, "+"/"-" 수량 조절 버튼
    -   **카페라떼**: 현재 재고 "10개" 표시, "+"/"-" 수량 조절 버튼

**주문 현황 섹션:**

-   **섹션 제목**: "주문 현황" 표시
-   **주문 목록** (회색 테두리 사각형 내 표시):
    -   주문 정보 카드: 날짜/시간, 주문 항목, 가격
    -   예시: "7월 31일 13:00", "아메리카노(ICE) x 1", "4,000원"
    -   **주문 상태 버튼**: "주문 접수" 등의 상태 표시 및 변경 버튼

#### 4.2.4 사용자 플로우

1. **대시보드 확인**: 관리자 대시보드에서 전체 주문 현황 파악
2. **재고 관리**:
    - 각 메뉴별 현재 재고 수량 확인
    - 필요 시 "+" 버튼으로 재고 증가 또는 "-" 버튼으로 재고 감소
    - 재고 변경 시 실시간으로 데이터베이스 업데이트
3. **주문 처리**:
    - 주문 현황 섹션에서 새로운 주문 확인
    - 주문 상태 버튼 클릭하여 다음 단계로 진행
    - 주문 처리 완료 시 대시보드 숫자 업데이트
4. **실시간 모니터링**: 새 주문 발생 시 실시간으로 화면 업데이트

#### 4.2.5 기능 상세

**대시보드 기능:**

-   각 주문 상태별 카운터 실시간 업데이트
-   총 주문 수는 모든 주문 상태의 합계
-   각 상태별 주문 수는 해당 상태의 주문 건수만 표시

**재고 관리 기능:**

-   "+" 버튼 클릭 시 재고 수량 1 증가
-   "-" 버튼 클릭 시 재고 수량 1 감소 (0 미만으로는 감소 불가)
-   재고 변경 시 즉시 시각적 업데이트 및 데이터베이스 반영
-   재고 부족 시 경고 메시지 표시 (옵션)

**주문 상태 관리:**

-   주문 상태 버튼 클릭 시 다음 단계로 상태 전환
-   상태 전환 순서: "주문 접수" → "제조 중" → "제조 완료"
-   각 상태 변경 시 대시보드 숫자 실시간 업데이트

**실시간 업데이트:**

-   새로운 주문 접수 시 주문 현황 섹션에 자동 추가
-   주문 상태 변경 시 대시보드 통계 실시간 반영

#### 4.2.6 데이터 모델

**주문 데이터:**

-   주문 ID, 주문 시간, 주문 상태, 주문 총액
-   주문 상태: "주문 접수", "제조 중", "제조 완료"

**재고 데이터:**

-   메뉴 ID, 현재 재고 수량, 최소 재고 수량 (임계치)

**주문 아이템 데이터:**

-   주문 ID, 메뉴 ID, 수량, 옵션 정보, 단위 가격

#### 4.2.7 UI/UX 요구사항

**반응형 디자인:**

-   대시보드 카드들이 다양한 화면 크기에 맞게 적절히 배치
-   모바일 환경에서도 재고 관리와 주문 확인이 가능하도록 구성

**상호작용 피드백:**

-   버튼 클릭 시 즉시 시각적 피드백 제공
-   재고 수량 변경 시 애니메이션 효과로 변경사항 강조
-   주문 상태 변경 시 버튼 텍스트 및 색상 변화

**실시간 업데이트:**

-   WebSocket 또는 실시간 폴링을 통한 실시간 데이터 동기화
-   새 주문 발생 시 알림 효과 (시각적 또는 사운드)
-   데이터 변경 시 자동 새로고침으로 최신 상태 유지

**접근성:**

-   재고 조절 버튼에 명확한 라벨 제공
-   주문 상태 변경 시 확인 메시지 표시
-   키보드 네비게이션 지원

## 5. 백엔드 개발 가이드

### 5.1 데이터 모델

#### 5.1.1 Menus 테이블

커피 메뉴 정보를 저장하는 테이블

| 컬럼명      | 타입               | 설명           | 예시                                   |
| ----------- | ------------------ | -------------- | -------------------------------------- |
| id          | SERIAL PRIMARY KEY | 메뉴 고유 ID   | 1, 2, 3                                |
| name        | VARCHAR(100)       | 커피 이름      | "아메리카노(ICE)", "카페라떼"          |
| description | TEXT               | 메뉴 설명      | "깔끔한 에스프레소와 차가운 물의 조화" |
| price       | INTEGER            | 기본 가격 (원) | 4000, 5000                             |
| image_url   | VARCHAR(255)       | 이미지 URL     | "/images/americano-ice.jpg"            |
| stock       | INTEGER            | 재고 수량      | 10, 5, 0                               |
| created_at  | TIMESTAMP          | 생성일시       | 2024-01-01 00:00:00                    |
| updated_at  | TIMESTAMP          | 수정일시       | 2024-01-01 00:00:00                    |

#### 5.1.2 Options 테이블

메뉴 옵션 정보를 저장하는 테이블

| 컬럼명     | 타입               | 설명           | 예시                   |
| ---------- | ------------------ | -------------- | ---------------------- |
| id         | SERIAL PRIMARY KEY | 옵션 고유 ID   | 1, 2, 3                |
| name       | VARCHAR(100)       | 옵션 이름      | "샷 추가", "시럽 추가" |
| price      | INTEGER            | 추가 가격 (원) | 500, 0                 |
| menu_id    | INTEGER            | 연결된 메뉴 ID | 1, 2, 3 (FK)           |
| created_at | TIMESTAMP          | 생성일시       | 2024-01-01 00:00:00    |

#### 5.1.3 Orders 테이블

주문 정보를 저장하는 테이블

| 컬럼명       | 타입               | 설명           | 예시                              |
| ------------ | ------------------ | -------------- | --------------------------------- |
| id           | SERIAL PRIMARY KEY | 주문 고유 ID   | 1, 2, 3                           |
| order_time   | TIMESTAMP          | 주문 일시      | 2024-07-31 13:00:00               |
| status       | VARCHAR(20)        | 주문 상태      | "RECEIVED", "MAKING", "COMPLETED" |
| total_amount | INTEGER            | 주문 총액 (원) | 4000, 8500                        |
| created_at   | TIMESTAMP          | 생성일시       | 2024-01-01 00:00:00               |
| updated_at   | TIMESTAMP          | 수정일시       | 2024-01-01 00:00:00               |

#### 5.1.4 Order_Items 테이블

주문 상세 정보를 저장하는 테이블

| 컬럼명     | 타입               | 설명                | 예시                           |
| ---------- | ------------------ | ------------------- | ------------------------------ |
| id         | SERIAL PRIMARY KEY | 주문 아이템 고유 ID | 1, 2, 3                        |
| order_id   | INTEGER            | 주문 ID             | 1, 2, 3 (FK)                   |
| menu_id    | INTEGER            | 메뉴 ID             | 1, 2, 3 (FK)                   |
| quantity   | INTEGER            | 수량                | 1, 2, 3                        |
| unit_price | INTEGER            | 단위 가격 (원)      | 4000, 4500                     |
| options    | JSONB              | 선택된 옵션 정보    | [{"id": 1, "name": "샷 추가"}] |

### 5.2 데이터 스키마를 위한 사용자 흐름

#### 5.2.1 메뉴 조회 및 표시

1. 프런트엔드에서 메뉴 목록 요청
2. 백엔드가 Menus 테이블에서 데이터 조회
3. 브라우저 화면에 메뉴 정보 표시 (이름, 설명, 가격, 이미지)
4. 관리자 화면에는 재고 수량도 함께 표시

#### 5.2.2 주문 프로세스

1. 사용자가 앱 화면에서 커피 메뉴 선택 및 옵션 설정
2. 선택 정보가 장바구니에 표시됨 (프런트엔드 상태 관리)
3. 장바구니에서 '주문하기' 버튼 클릭
4. 주문 정보가 Orders 테이블에 저장:
    - 주문 시간: 현재 시각
    - 주문 내용: Order_Items 테이블에 메뉴, 수량, 옵션, 금액 저장
5. 주문 완료 후 재고 수량 자동 차감

#### 5.2.3 관리자 주문 관리

1. Orders 테이블의 정보를 관리자 화면 '주문 현황'에 표시
2. 주문 기본 상태: "RECEIVED" (주문 접수)
3. 상태 변경 플로우:
    - "RECEIVED" → "MAKING" (제조 중)
    - "MAKING" → "COMPLETED" (제조 완료)
4. 각 상태 변경 시 Orders 테이블 업데이트

### 5.3 API 설계

#### 5.3.1 메뉴 관련 API

**GET /api/menus**

-   목적: 커피 메뉴 목록 조회
-   설명: 주문 화면과 관리자 화면에서 사용하는 메뉴 데이터 제공
-   응답 예시:

```json
{
    "success": true,
    "data": [
        {
            "id": 1,
            "name": "아메리카노(ICE)",
            "description": "깔끔한 에스프레소와 차가운 물의 조화",
            "price": 4000,
            "image_url": "/images/americano-ice.jpg",
            "stock": 10,
            "options": [
                {
                    "id": 1,
                    "name": "샷 추가",
                    "price": 500
                },
                {
                    "id": 2,
                    "name": "시럽 추가",
                    "price": 0
                }
            ]
        }
    ]
}
```

**PUT /api/menus/:id/stock**

-   목적: 재고 수량 수정
-   설명: 관리자가 재고 수량을 조절할 때 사용
-   요청 본문:

```json
{
    "stock": 15
}
```

#### 5.3.2 주문 관련 API

**POST /api/orders**

-   목적: 주문 생성
-   설명: 사용자가 주문하기 버튼을 클릭할 때 주문 정보 저장
-   요청 본문:

```json
{
    "items": [
        {
            "menu_id": 1,
            "quantity": 1,
            "options": [
                {
                    "id": 1,
                    "name": "샷 추가",
                    "price": 500
                }
            ],
            "unit_price": 4500
        }
    ],
    "total_amount": 4500
}
```

**GET /api/orders**

-   목적: 주문 목록 조회
-   설명: 관리자 화면에서 모든 주문 정보 조회
-   응답 예시:

```json
{
    "success": true,
    "data": [
        {
            "id": 1,
            "order_time": "2024-07-31T13:00:00Z",
            "status": "RECEIVED",
            "total_amount": 4500,
            "items": [
                {
                    "id": 1,
                    "menu_name": "아메리카노(ICE)",
                    "quantity": 1,
                    "unit_price": 4500,
                    "options": [
                        {
                            "name": "샷 추가",
                            "price": 500
                        }
                    ]
                }
            ]
        }
    ]
}
```

**GET /api/orders/:id**

-   목적: 특정 주문 조회
-   설명: 주문 ID로 해당 주문의 상세 정보 조회
-   응답: 위의 주문 객체와 동일한 구조

**PUT /api/orders/:id/status**

-   목적: 주문 상태 변경
-   설명: 관리자가 주문 상태를 변경할 때 사용
-   요청 본문:

```json
{
    "status": "MAKING"
}
```

#### 5.3.3 에러 처리

모든 API는 일관된 에러 응답 형식을 사용:

```json
{
    "success": false,
    "error": {
        "code": "INVALID_REQUEST",
        "message": "요청 데이터가 올바르지 않습니다.",
        "details": {}
    }
}
```

### 5.4 데이터베이스 트랜잭션 처리

#### 5.4.1 주문 생성 시 트랜잭션

1. 주문 정보를 Orders 테이블에 저장
2. 주문 상세 정보를 Order_Items 테이블에 저장
3. 각 메뉴의 재고 수량 차감
4. 모든 작업이 성공해야 트랜잭션 커밋, 하나라도 실패하면 롤백

#### 5.4.2 재고 부족 처리

-   주문 시 재고 수량이 부족한 경우 주문 실패 처리
-   관리자에게 재고 부족 알림 제공
